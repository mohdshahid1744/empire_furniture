<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Untree.co">
  <link rel="apple-touch-icon" sizes="180x180" href="/static/favicon.png">


  <meta name="description" content="" />
  <meta name="keywords" content="bootstrap, bootstrap4" />

		<!-- Bootstrap CSS -->
		<link href="/static/bootstrap.min.css" rel="stylesheet">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
		<link href="/static/tiny-slider.css" rel="stylesheet">
		<link href="/static/style2.css" rel="stylesheet">
		<link href="/static/style4.css" rel="stylesheet">
		 <script src="path-to-elevate-zoom-js/jquery.elevateZoom-3.0.8.min.js"></script>
		 <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Bootstrap JS -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<!-- Popper.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>

<!-- Bootstrap JS -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<style>
  .order-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
  }
  .order-details-container {
        text-decoration: none; 
    }
  .order-card {
      background-color: #3b5d50;
      border: 1px solid #ddd;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      margin: 10px;
      padding: 15px;
      width: 100%; 
      transition: transform 0.3s;
  }

  .order-card:hover {
      transform: scale(1.05);
  }

  .order-header {
      border-bottom: 1px solid #ddd;
      margin-bottom: 10px;
      padding-bottom: 10px;
  }

  .order-header h2 {
      color: #007bff;
      font-size: 1.2rem;
      margin-bottom: 5px;
  }

  .order-header p {
      font-size: 0.9rem;
      color: white;
  }

  .product-details {
      margin-top: 15px;
  }

  .product-details h3 {
      color: black;
      font-weight: bold;
      font-size: 1rem;
      margin-bottom: 5px;
  }

  .product-details p {
      font-size: 0.9rem;
      color: white;
      margin: 0;
  }

  .no-orders-message {
      color: #6c757d;
      font-size: 1.2rem;
      margin-top: 20px;
  }
</style>



    <title>Empire Furniture</title>
</head>

<body>

    <!-- Start Header/Navigation -->
    <nav class="custom-navbar navbar navbar-expand-md navbar-dark bg-dark" aria-label="Furni navigation bar">

        <div class="container">
            <a class="navbar-brand" href="/home">Empire <span style="color: red;">Furniture</span></a>

            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsFurni" aria-controls="navbarsFurni" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarsFurni">
                <ul class="custom-navbar-nav navbar-nav ms-auto mb-2 mb-md-0">
                    <li class="nav-item">
                        <a class="nav-link" href="/home">Home</a>
                    </li>
                    <li><a class="nav-link" href="/shop">Shop</a></li>
                    <li><a class="nav-link" href="/services">Services</a></li>
                    <li><a class="nav-link" href="/blog">Blog</a></li>
                    <li><a class="nav-link" href="/contact">Contact us</a></li>
                </ul>

                <ul class="custom-navbar-cta navbar-nav mb-2 mb-md-0 ms-5">
                    <li><a class="nav-link" href="/userinfo"><img src="/static/user.svg" alt="User"></a></li>
                    <li><a class="nav-link" href="/cart"><img src="/static/cart.svg" alt="Cart"></a></li>
                </ul>

                <div class="mt-2">
                    <form action="/logout" method="post" class="d-grid">
                        <button type="submit" class="btn btn-warning" style="margin-left: 50px;">Logout</button>
                    </form>
                </div>
            </div>
        </div>

    </nav>
    <!-- End Header/Navigation -->

    <!-- Start Hero Section -->
    <div class="hero" style="padding: 10px;">
        <div class="container">
            <div class="row justify-content-between">
                <div class="col-lg-5">
                    <div class="intro-excerpt">
                        <h1>My Orders</h1>
                    </div>
                </div>
                <div class="col-lg-7">

                </div>
            </div>
        </div>
    </div>
    <!-- End Hero Section -->

   <!-- Start Order Details Section -->
   <% if (orders.length > 0) { %>
    <div class="order-container">
        <% for (let i = orders.length - 1; i >= 0; i--) { %>
            <% const order = orders[i]; %>
            <a href="/orderdetails/<%= order._id %>" class="container order-details-container" style="margin-bottom: 20px; margin-top: 20px;">
                <div class="order-card">
                    <div class="order-header">
                        <h2>Order Status</h2>
                        <p>Order ID: <%= order._id %></p>
                    </div>

                    <div class="order-content">
                        <% order.products.forEach((product) => { %>
                            <div class="product-details">
                                <h3><%= product.productName %></h3>
                                <p>Quantity: <%= product.quantity %></p>
                                <p>Price: <%= product.productPrice %></p>
                             
                            </div>
                        <% }); %>
                    </div>

                </div>
            </a>
        <% } %>
    </div>
<% } else { %>
    <p class="no-orders-message">You have no orders yet.</p>
<% } %>
<!-- End Order Details Section -->


		<!-- Start Footer Section -->
		<footer class="footer-section" style="margin-top: 150px;">
			<div class="container relative">

				<div class="sofa-img">
					<img src="/static/sofa.png" alt="Image" class="img-fluid">
				</div>

				<div class="row">
					<div class="col-lg-8">
						<div class="subscription-form">
							<h3 class="d-flex align-items-center"><span class="me-1"><img src="/static/envelope-outline.svg" alt="Image" class="img-fluid"></span><span>Subscribe to Newsletter</span></h3>

							<form action="#" class="row g-3">
								<div class="col-auto">
									<input type="text" class="form-control" placeholder="Enter your name">
								</div>
								<div class="col-auto">
									<input type="email" class="form-control" placeholder="Enter your email">
								</div>
								<div class="col-auto">
									<button class="btn btn-primary">
										<span class="fa fa-paper-plane"></span>
									</button>
								</div>
							</form>

						</div>
					</div>
				</div>

				<div class="row g-5 mb-5">
					<div class="col-lg-4">
						<div class="mb-4 footer-logo-wrap"><a href="#" class="footer-logo">Empire <span style="color: red;">Furniture</span></a></div>
						<p class="mb-4">our products are crafted with exceptional materials, ensuring durability and longevity. We take pride in offering modern interior design solutions that not only enhance the aesthetics of any space but also provide utmost comfort and functionality. </p>

						<ul class="list-unstyled custom-social">
							<li><a href="#"><span class="fa fa-brands fa-facebook-f"></span></a></li>
							<li><a href="#"><span class="fa fa-brands fa-twitter"></span></a></li>
							<li><a href="#"><span class="fa fa-brands fa-instagram"></span></a></li>
							<li><a href="#"><span class="fa fa-brands fa-linkedin"></span></a></li>
						</ul>
					</div>

					<div class="col-lg-8">
						<div class="row links-wrap">
							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">About us</a></li>
									<li><a href="#">Services</a></li>
									<li><a href="#">Blog</a></li>
									<li><a href="#">Contact us</a></li>
								</ul>
							</div>

							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">Support</a></li>
									<li><a href="#">Privacy Policy</a></li>
								</ul>
							</div>

							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">Jobs</a></li>
									<li><a href="#">Delivery</a></li>
									<li><a href="#">Payment methods</a></li>
									<li><a href="#">Return & Exchange</a></li>
								</ul>
							</div>

						
						</div>
					</div>

				</div>

				<div class="border-top copyright">
					<div class="row pt-4">
						<div class="col-lg-6">
							<p class="mb-2 text-center text-lg-start">Copyright &copy;<script>document.write(new Date().getFullYear());</script>. All Rights Reserved. &mdash; Designed with love by <a href="https://untree.co">Untree.co</a> Distributed By <a hreff="https://themewagon.com">ThemeWagon</a>  <!-- License information: https://untree.co/license/ -->
            </p>
						</div>

						<div class="col-lg-6 text-center text-lg-end">
							<ul class="list-unstyled d-inline-flex ms-auto">
								<li class="me-4"><a href="#">Terms &amp; Conditions</a></li>
								<li><a href="#">Privacy Policy</a></li>
							</ul>
						</div>

					</div>
				</div>

			</div>
		</footer>
		<!-- End Footer Section -->	

    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/tiny-slider.js"></script>
    <script src="js/custom.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10.16.6/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10.16.6/dist/sweetalert2.min.js"></script>
   
    <script>
      function showAddressAlert(name, number, house, street, city, state, country, pincode) {
  const addressString = `
    Name: ${name}
    Number: ${number}
    House: ${house}
    Street: ${street}
    City: ${city}
    State: ${state}
    Country: ${country}
    Pincode: ${pincode}
  `;

  Swal.fire({
    title: 'Address',
    html: addressString,
  });
}

      const cancelledOrders = JSON.parse(localStorage.getItem('cancelledOrders')) || {};
  
      function cancelOrder(orderId, button) {
        if (cancelledOrders[orderId]) {
          return;
        }
  
       
        Swal.fire({
          title: 'Reason for Cancellation',
          input: 'text',
          inputAttributes: {
            autocapitalize: 'off'
          },
          showCancelButton: true,
          confirmButtonText: 'Submit',
          showLoaderOnConfirm: true,
          preConfirm: (reason) => {
            if (reason.trim() === '') {
              Swal.showValidationMessage('Please enter a reason');
            }
          },
          allowOutsideClick: () => !Swal.isLoading()
        }).then((result) => {
          if (result.isConfirmed) {
            const reason = result.value;
            const cancellationDate = new Date().toLocaleDateString();
            fetch(`/cancel-order/${orderId}`, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify({ reason, cancellationDate }),
            })
              .then((response) => {
                if (response.ok) {
                  button.textContent = `Cancelled . Will be returned in 4 days.`;
                  button.classList.add('cancelled-button');
                  cancelledOrders[orderId] = cancellationDate;
                  localStorage.setItem('cancelledOrders', JSON.stringify(cancelledOrders));
                  console.log('Order successfully canceled');
                  location.reload()
                } else {
                  console.error('Error cancelling the order');
                }
              })
              .catch((error) => {
                console.error('Error cancelling the order:', error);
              });
          }
        });
      }
    </script>
    <script>
        const returnedOrders = JSON.parse(localStorage.getItem('returnedOrders')) || {};
      
        function returnOrder(orderId, button) {
          if (returnedOrders[orderId]) {
            return;
          }
      
          Swal.fire({
            title: 'Reason for Return',
            input: 'text',
            inputAttributes: {
              autocapitalize: 'off'
            },
            showCancelButton: true,
            confirmButtonText: 'Submit',
            showLoaderOnConfirm: true,
            preConfirm: (reason) => {
              if (reason.trim() === '') {
                Swal.showValidationMessage('Please enter a reason');
              }
            },
            allowOutsideClick: () => !Swal.isLoading()
          }).then((result) => {
            if (result.isConfirmed) {
              const reason = result.value;
              const returnDate = new Date().toLocaleDateString();
              fetch(`/returnOrder/${orderId}`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                },
                body: JSON.stringify({ reason, returnDate }),
              })
                .then((response) => {
                  if (response.ok) {
                    button.textContent = 'Returned. Thank you for your feedback.';
                    button.classList.add('returned-button');
                    returnedOrders[orderId] = returnDate;
                    localStorage.setItem('returnedOrders', JSON.stringify(returnedOrders));
                    console.log('Order successfully returned');
                  } else {
                    console.error('Error returning the order');
                  }
                })
                .catch((error) => {
                  console.error('Error returning the order:', error);
                });
            }
          });
        }
       
      </script>
      
</body>

</html>
